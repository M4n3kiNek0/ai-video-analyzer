============================= test session starts ==============================
platform linux -- Python 3.10.19, pytest-9.0.2, pluggy-1.6.0 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /app
plugins: anyio-4.12.0
collecting ... collected 1 item

tests/test_video_processor.py::TestVideoProcessor::test_extract_audio FAILED [100%]

=================================== FAILURES ===================================
____________________ TestVideoProcessor.test_extract_audio _____________________

self = <tests.test_video_processor.TestVideoProcessor object at 0x701fe20cb6a0>
mock_run = <MagicMock name='run' id='123282238783152'>
mock_capture_cls = <MagicMock name='VideoCapture' id='123282238780032'>

    @patch('video_processor.cv2.VideoCapture')
    @patch('subprocess.run')
    def test_extract_audio(self, mock_run, mock_capture_cls):
        """Test extract_audio method (mocking ffmpeg)."""
        # Mock VideoCapture to avoid initialization error
        mock_cap = MagicMock()
        mock_cap.isOpened.return_value = True
        mock_capture_cls.return_value = mock_cap
    
>       processor = VideoProcessor(self.video_path)

tests/test_video_processor.py:74: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <video_processor.VideoProcessor object at 0x701fe2122c20>
video_path = '/tmp/tmpi5ispoan/test_video.mp4'

    def __init__(self, video_path: str):
        """
        Initialize video processor with video file path.
    
        Args:
            video_path: Path to the video file
        """
        self.video_path = video_path
        self.cap = cv2.VideoCapture(video_path)
    
        if not self.cap.isOpened():
            raise ValueError(f"Cannot open video file: {video_path}")
    
        self.fps = self.cap.get(cv2.CAP_PROP_FPS)
        self.total_frames = int(self.cap.get(cv2.CAP_PROP_FRAME_COUNT))
        self.width = int(self.cap.get(cv2.CAP_PROP_FRAME_WIDTH))
        self.height = int(self.cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
>       self.duration = self.total_frames / self.fps if self.fps > 0 else 0
E       TypeError: '>' not supported between instances of 'MagicMock' and 'int'

video_processor.py:80: TypeError
=========================== short test summary info ============================
FAILED tests/test_video_processor.py::TestVideoProcessor::test_extract_audio - TypeError: '>' not supported between instances of 'MagicMock' and 'int'
============================== 1 failed in 1.02s ===============================
